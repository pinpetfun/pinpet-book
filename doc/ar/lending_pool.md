# ๐ฆ ููุฏูุฉ ุนู ูุธููุฉ ูุฌูุน ุงูุฅูุฑุงุถ

## ุฃููุงูุ ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฌูุน ุงูุฅูุฑุงุถ ูู PinPet ูู ูุญุฏุฉ ุฃุณุงุณูุฉ ุชุฏุนู ุงูุชุฏุงูู ุจุงูุฑุงูุนุฉ ุงููุงููุฉุ ููููุฑ ูููุณุชุฎุฏููู ุฎุฏูุงุช ุฅูุฑุงุถ SOL ูุงูุฑููุฒ ูุชุญููู ูุธุงุฆู ุงูุดุฑุงุก (Long) ูุงูุจูุน (Short). ูุนุชูุฏ ูุฌูุน ุงูุฅูุฑุงุถ ุนูู ุขููุฉ **ูุฌูุน ุงุญุชูุงุทู ุงูุชุฑุงุถู**ุ ูุณุชูู ุนู ูุฌูุน ุงูุณูููุฉ ูู ุงูุชุฏุงูู ุงูููุฑูุ ููุง ูุถูู ุฃู ุงูุชุฏุงูู ุจุงูุฑุงูุนุฉ ุงููุงููุฉ ูุง ูุคุซุฑ ุนูู ุงูุชุดุบูู ุงูุทุจูุนู ูุณูู ุงูุชุฏุงูู ุงูููุฑู.

## ุซุงููุงูุ ๐ญ ุงูุฏูุฑ ุงููุฒุฏูุฌ ููุฌูุน ุงูุฅูุฑุงุถ

### 2.1 ๐ฐ ููุฌูุน ุชูููู
- **ูุฌูุน ุฅูุฑุงุถ SOL**: ูููุฑ ูุฑูุถ SOL ูููุชุฏุงูููู ุงูุฐูู ููุชุญูู ูุฑุงูุฒ ุดุฑุงุก
- **ูุฌูุน ุฅูุฑุงุถ ุงูุฑููุฒ**: ูููุฑ ูุฑูุถ ุงูุฑููุฒ ูููุชุฏุงูููู ุงูุฐูู ููุชุญูู ูุฑุงูุฒ ุจูุน

### 2.2 ๐ฆ ุฅุฏุงุฑุฉ ุงูุงุญุชูุงุทู
ูุญุงูุธ ูุฌูุน ุงูุฅูุฑุงุถ ุนูู ุงุญุชูุงุทููู ุงูุชุฑุงุถููู ูุณุชูููู:

| ููุน ุงูุงุญุชูุงุทู | ุงููุตู | ุงูุบุฑุถ |
|---------|------|------|
| `borrow_sol_reserve` | ุงุญุชูุงุทู SOL ุงูุงูุชุฑุงุถู | ูููุชุฏุงูููู ุงูุฐูู ููุชุญูู ูุฑุงูุฒ ุดุฑุงุก |
| `borrow_token_reserve` | ุงุญุชูุงุทู ุงูุฑููุฒ ุงูุงูุชุฑุงุถู | ูููุชุฏุงูููู ุงูุฐูู ููุชุญูู ูุฑุงูุฒ ุจูุน |

ูุฐู ุงูุงุญุชูุงุทูุงุช ูู **ุฏูุงุชุฑ ุญุณุงุจุงุช ุงูุชุฑุงุถูุฉ**ุ ูุงูุฃููุงู ุงููุนููุฉ ูุฎุฒูุฉ ูู ูุฌูุน ุงูุณูููุฉ ุงูููุฑูุ ููุชู ุชุญููู ุงูุนุฒู ูู ุฎูุงู ุขููุฉ ููู ูุทุงู ุงูุณุนุฑ.

## ุซุงูุซุงูุ ๐ ุนูููุฉ ุงูุฅูุฑุงุถ ูู ุงูุชุฏุงูู ุจุงูุฑุงูุนุฉ ุงููุงููุฉ

### 3.1 ๐ ุงูุชุฏุงูู ุจุงูุดุฑุงุก (Long) - ุงูุชุฑุงุถ SOL ูุดุฑุงุก ุงูุฑููุฒ

#### โฌ๏ธ ูุฑุญูุฉ ูุชุญ ุงููุฑูุฒ
```mermaid
graph LR
    A[ุงููุณุชุฎุฏู ูุฏูุน ูุงูุด SOL] --> B[ุงูุชุฑุงุถ SOL ูู ูุฌูุน ุงูุฅูุฑุงุถ]
    B --> C[ุงุณุชุฎุฏุงู SOL ูุดุฑุงุก ุงูุฑููุฒ]
    C --> D[ููู ูุทุงู ุงูุณุนุฑ]
    D --> E[ุฅูุดุงุก ุฃูุฑ ุดุฑุงุก]
```

**ุงูุนูููุฉ ุงูุชูุตูููุฉ**:
1. **ุงุณุชุซูุงุฑ ุงููุณุชุฎุฏู**: ุฏูุน ุงููุงูุด (ูุซุงู 0.5 SOL) ๐ต
2. **ุฅูุฑุงุถ ุงููุฌูุน**: ุงูุชุฑุงุถ SOL ูู `borrow_sol_reserve` (ูุซุงู 4.5 SOL) ๐ธ
3. **ุชูููุฐ ุงูุตููุฉ**: ุงุณุชุฎุฏุงู ุฅุฌูุงูู 5 SOL ูุดุฑุงุก ุงูุฑููุฒ ุนูู AMM โ๏ธ
4. **ููู ูุทุงู ุงูุณุนุฑ**: ุชุณุฌูู ูุทุงู ุงูุณุนุฑ ุนูุฏ ุงูุดุฑุงุกุ ูุณุชุฎุฏู ูุญุณุงุจ ุฅุบูุงู ุงููุฑูุฒ ๐
5. **ุชุณุฌูู ุงูุฃูุฑ**: ุฅูุดุงุก `MarginOrder`ุ ุชุณุฌูู ูุจูุบ ุงููุฑุถุ ุงููุงูุดุ ูููุฉ ุงูุฑููุฒ ุงููุญุชูุธ ุจูุง ๐


#### โฌ๏ธ ูุฑุญูุฉ ุฅุบูุงู ุงููุฑูุฒ
```mermaid
graph LR
    A[ุจูุน ุงูุฑููุฒ ุงููุญุชูุธ ุจูุง] --> B[ุงูุญุตูู ุนูู SOL]
    B --> C{ุญุณุงุจ ุงูุฑุจุญ ูุงูุฎุณุงุฑุฉ}
    C -->|ุฑุจุญ| D[ุฅุนุงุฏุฉ ุงููุฑุถ + ุงููุงูุด + ุงูุฑุจุญ ูููุณุชุฎุฏู]
    C -->|ุฎุณุงุฑุฉ| E[ุฅุนุงุฏุฉ ุงููุฑุถ + ุงููุงูุด ุงููุชุจูู ูููุณุชุฎุฏู]
    D --> F[ุชุญุฏูุซ borrow_sol_reserve]
    E --> F
```

**ุชุณููุฉ ุงูุฃููุงู**:
- ุฅุฌูุงูู SOL ุงููุญุตู ูู ุจูุน ุงูุฑููุฒ = `output_sol` ๐ฐ
- ุฎุตู ุฑุณูู ุงูุชุฏุงูู ๐ธ
- ุฅุนุงุฏุฉ ุงููุฑุถ ููุฌูุน ุงูุฅูุฑุงุถ: `borrow_amount` ูุนูุฏ ุฅูู `borrow_sol_reserve` โฌ๏ธ
- ุนุงุฆุฏ ุงููุณุชุฎุฏู = ุงูุฅุฌูุงูู - ุงููุฑุถ - ุงููุงูุด โ

### 3.2 ๐ ุงูุชุฏุงูู ุจุงูุจูุน (Short) - ุงูุชุฑุงุถ ุงูุฑููุฒ ูุจูุนูุง ููุงุจู SOL

#### โฌ๏ธ ูุฑุญูุฉ ูุชุญ ุงููุฑูุฒ
```mermaid
graph LR
    A[ุงููุณุชุฎุฏู ูุฏูุน ูุงูุด SOL] --> B[ุงูุชุฑุงุถ ุงูุฑููุฒ ูู ูุฌูุน ุงูุฅูุฑุงุถ]
    B --> C[ุจูุน ุงูุฑููุฒ ููุญุตูู ุนูู SOL]
    C --> D[ููู ูุทุงู ุงูุณุนุฑ]
    D --> E[ุฅูุดุงุก ุฃูุฑ ุจูุน]
```

**ุงูุนูููุฉ ุงูุชูุตูููุฉ**:
1. **ุงุณุชุซูุงุฑ ุงููุณุชุฎุฏู**: ุฏูุน ูุงูุด SOL ๐ต
2. **ุฅูุฑุงุถ ุงููุฌูุน**: ุงูุชุฑุงุถ ุงูุฑููุฒ ูู `borrow_token_reserve` ๐
3. **ุชูููุฐ ุงูุตููุฉ**: ุจูุน ุงูุฑููุฒ ููุญุตูู ุนูู SOLุ ุฅูุฏุงุนูุง ูู ูุฌูุน ุงูุฃููุงู โ๏ธ
4. **ููู ูุทุงู ุงูุณุนุฑ**: ุชุณุฌูู ูุทุงู ุงูุณุนุฑ ุนูุฏ ุงูุจูุน ๐
5. **ุชุณุฌูู ุงูุฃูุฑ**: ุฅูุดุงุก `MarginOrder`ุ ุชุณุฌูู ูููุฉ ุงูุฑููุฒ ุงูููุชุฑุถุฉุ ุงููุงูุดุ SOL ุงููุญุชูุธ ุจู ๐



#### โฌ๏ธ ูุฑุญูุฉ ุฅุบูุงู ุงููุฑูุฒ
```mermaid
graph LR
    A[ุงุณุชุฎุฏุงู SOL ูุฅุนุงุฏุฉ ุดุฑุงุก ุงูุฑููุฒ] --> B[ุฅุนุงุฏุฉ ุงูุฑููุฒ ููุฌูุน ุงูุฅูุฑุงุถ]
    B --> C{ุญุณุงุจ ุงูุฑุจุญ ูุงูุฎุณุงุฑุฉ}
    C -->|ุฑุจุญ| D[SOL ุงููุชุจูู = ุงููุงูุด + ุงูุฑุจุญ]
    C -->|ุฎุณุงุฑุฉ| E[SOL ุงููุชุจูู = ุงููุงูุด - ุงูุฎุณุงุฑุฉ]
    D --> F[ุงูุฏูุน ูููุณุชุฎุฏู]
    E --> F
    F --> G[ุชุญุฏูุซ borrow_token_reserve]
```

**ุชุณููุฉ ุงูุฃููุงู**:
- ุฅุฌูุงูู SOL ุงููุทููุจ ูุฅุนุงุฏุฉ ุดุฑุงุก ุงูุฑููุฒ = `required_sol` + ุงูุฑุณูู ๐ฐ
- ุฅุนุงุฏุฉ ุงููุฑุถ ููุฌูุน ุงูุฅูุฑุงุถ: `borrow_amount` (ุฑููุฒ) ูุนูุฏ ุฅูู `borrow_token_reserve` โฌ๏ธ
- ุนุงุฆุฏ ุงููุณุชุฎุฏู = SOL ุงููุญุตู ูู ุจูุน ุงูุฑููุฒ ุนูุฏ ูุชุญ ุงููุฑูุฒ - SOL ุงููุณุชุฎุฏู ูุดุฑุงุก ุงูุฑููุฒ ุนูุฏ ุฅุบูุงู ุงููุฑูุฒ - ุงููุงูุด โ

## ุฑุงุจุนุงูุ ๐ธ ุขููุฉ ุงูุณุฏุงุฏ ูู ูุฌูุน ุงูุฅูุฑุงุถ

### 4.1 โ ุณุฏุงุฏ ุนูุฏ ุฅุบูุงู ุงููุฑูุฒ ุงููุดุท
ุนูุฏูุง ูุบูู ุงููุณุชุฎุฏู ุงููุฑูุฒ ุจุดูู ูุดุทุ ูููุฐ ุงููุธุงู ุงูุณุฏุงุฏ ุชููุงุฆูุงู:

| ููุน ุงูุตููุฉ | ุฃุตู ุงูุณุฏุงุฏ | ูุตุฏุฑ ุงูุณุฏุงุฏ | ุงูุงุญุชูุงุทู ุงููุนุงุฏ |
|---------|---------|---------|---------|
| ุฅุบูุงู ูุฑูุฒ ุดุฑุงุก | SOL | ูู ุจูุน ุงูุฑููุฒ | `borrow_sol_reserve` |
| ุฅุบูุงู ูุฑูุฒ ุจูุน | ุฑููุฒ | ูู ุฅุนุงุฏุฉ ุดุฑุงุก ุงูุฑููุฒ | `borrow_token_reserve` |

**ุฃููููุฉ ุงูุณุฏุงุฏ**:
1. ุฎุตู ุฑุณูู ุงูุชุฏุงูู ๐ธ
2. ุฅุนุงุฏุฉ ุฑุฃุณ ุงููุงู ุงูููุชุฑุถ โฌ๏ธ
3. ุฅุนุงุฏุฉ ุงููุงูุด ๐ฐ
4. ุชูุฒูุน ุงูุฃุฑุจุงุญ/ูุนุงูุฌุฉ ุงูุฎุณุงุฆุฑ ๐

### 4.2 โ๏ธ ุณุฏุงุฏ ุนูุฏ ุงูุชุตููุฉ ุงููุณุฑูุฉ
ุนูุฏูุง ูุตู ุงูุณุนุฑ ุฅูู ุณุนุฑ ููู ุงูุฎุณุงุฑุฉ/ุฌูู ุงูุฑุจุญุ ูููู ุงููุธุงู ุจุฅุบูุงู ุงููุฑูุฒ ูุณุฑูุงู ุชููุงุฆูุงู:

```mermaid
graph TD
    A[ูุฑุงูุจุฉ ุงูุณุนุฑ] --> B{ุดุฑุท ุงูุชูุนููุ}
    B -->|ููู ุฎุณุงุฑุฉ ุงูุดุฑุงุก| C[ุงูุณุนุฑ โค lock_lp_start_price]
    B -->|ุฌูู ุฑุจุญ ุงูุจูุน| D[ุงูุณุนุฑ โฅ lock_lp_start_price]
    C --> E[ุฅุบูุงู ูุณุฑู]
    D --> E
    E --> F[ุญุณุงุจ ุญุณุจ ูุทุงู ุงูุณุนุฑ ุงููููู]
    F --> G[ุฅุนุงุฏุฉ ุงููุฑุถ]
    G --> H[ุฅุนุงุฏุฉ ุงููุงูุด ุงููุชุจูู]
```

**ุญูุงูุฉ ุงูุชุตููุฉ** ๐ก๏ธ:
- ูู ุฎูุงู ููู ูุทุงู ุงูุณุนุฑุ ูุถูู ุฃูู ุญุชู ุฅุฐุง ุชููุจ ุณุนุฑ ุงูุณูู ุจุดูู ูุจูุฑุ ูููู ุฅุบูุงู ุงููุฑูุฒ ุจุงูุณุนุฑ ุงููุญุฏุฏ ูุณุจูุงู
- ุชุตููู ุงููุงูุด ูุถูู ุฃูุงู ุฃููุงู ูุฌูุน ุงูุฅูุฑุงุถ

### 4.3 โฐ ุชุตููุฉ ุนูุฏ ุงูุงูุชูุงุก
ุจุนุฏ ุงูุชูุงุก ุตูุงุญูุฉ ุงูุฃูุฑุ ูููู ูุฃู ุดุฎุต ุชูุนูู ุฅุบูุงู ุงููุฑูุฒ:

- ุฃูุฑ ุงูุดุฑุงุก: ููุช ุงูุงูุชูุงุก `end_time` = ููุช ูุชุญ ุงููุฑูุฒ + `borrow_duration` โฑ๏ธ
- ุฃูุฑ ุงูุจูุน: ููุณ ุงูุดูุก
- ุจุนุฏ ุงูุงูุชูุงุกุ ูุชู ุฅุบูุงู ุงููุฑูุฒ ูุณุฑูุงู ุจุณุนุฑ ุงูุณูู ุงูุญุงููุ ูุฅุนุงุฏุฉ ุงููุฑุถ โก

## ุฎุงูุณุงูุ ๐ก๏ธ ุขููุฉ ุฃูุงู ุฃููุงู ูุฌูุน ุงูุฅูุฑุงุถ

### 5.1 ๐ผ ูุชุทูุจุงุช ุงููุงูุด
- **ุงููุงูุด ุงูุฃุฏูู**: `MIN_MARGIN_SOL_AMOUNT` (ูุนุงูู ุงููุธุงู) ๐ฐ
- **ูุณุจุฉ ุงููุงูุด**: ุชูุญุณุจ ุฏููุงููููุงู ุจูุงุกู ุนูู ูุถุงุนู ุงูุฑุงูุนุฉ ุงููุงููุฉ ููุทุงู ุชููุจ ุงูุณุนุฑ ๐
- **ุงุณุชุฎุฏุงู ุงููุงูุด**: ูุชุบุทูุฉ ุงูุฎุณุงุฆุฑ ูู ุญุงูุฉ ุชุญุฑู ุงูุณุนุฑ ุจุดูู ุบูุฑ ููุงุชู ๐

### 5.2 ๐ ููู ูุทุงู ุงูุณุนุฑ
ูู ุฃูุฑ ูููู ุณูููุฉ ูุทุงู ุณุนุฑ ูุญุฏุฏ:

```
ููู ุงูุดุฑุงุก: [lock_lp_start_price, lock_lp_end_price] (ูุทุงู ุงูุฎูุงุถ ุงูุณุนุฑ)
ููู ุงูุจูุน: [lock_lp_start_price, lock_lp_end_price] (ูุทุงู ุงุฑุชูุงุน ุงูุณุนุฑ)
```

ูุฐุง ูุถูู ูุฌูุฏ ุณูููุฉ ูุงููุฉ ูุฅุนุงุฏุฉ ุงููุฑุถ ุนูุฏ ุฅุบูุงู ุงููุฑูุฒ. โ

### 5.3 โ๏ธ ูุญุต ุงูุงุญุชูุงุทู
ูุจู ูุชุญ ุงููุฑูุฒุ ููุญุต ุงููุธุงู:

| ุนูุตุฑ ุงููุญุต | ุงูุดุฑุท | ุฑูุฒ ุงูุฎุทุฃ |
|-------|------|-------|
| ุงุญุชูุงุทู SOL | `required_borrow_sol โค borrow_sol_reserve` | `InsufficientBorrowingReserve` |
| ุงุญุชูุงุทู ุงูุฑููุฒ | `required_borrow_token โค borrow_token_reserve` | `InsufficientBorrowingReserve` |


## ุณุงุฏุณุงูุ ๐ธ ุขููุฉ ุงูุฑุณูู

### 6.1 ๐ ุฑุณูู ุงูุชุฏุงูู ุจุงูุฑุงูุนุฉ ุงููุงููุฉ
- **ูุนุฏู ุงูุฑุณูู**: `borrow_fee` (ูุซุงู 0.5% = 50 ููุทุฉ ุฃุณุงุณ) ๐ฐ
- **ุชูููุช ุงูุฑุณูู**: ุชูุญุตู ุนูุฏ ูุชุญ ูุฅุบูุงู ุงููุฑูุฒ โฐ
- **ุชูุฒูุน ุงูุฑุณูู**:
  - ุงูุดุฑูู: ูุณุจุฉ `fee_split` (ูุซุงู 80%) ๐ค
  - ูุฒูุฏ ุงูุชูููุฉ: 100% - `fee_split` (ูุซุงู 20%) โ๏ธ

### 6.2 โก ุฑุณูู ุงูุชุตููุฉ ุงููุณุฑูุฉ
- ุนูุฏ ุชูุนูู ุงูุชุตููุฉุ ูุชู ุชุญุตูู `borrow_fee` ุฅุถุงูู ูุฑุณูู ุชุตููุฉ ๐ธ
- ุชูุณุชุฎุฏู ูุชุญููุฒ ุงูุฃุทุฑุงู ุงูุซุงูุซุฉ ุนูู ุชูููุฐ ุงูุชุตููุฉ ุนูุฏ ุงูุงูุชูุงุก ๐ฏ

## ุณุงุจุนุงูุ ๐ฏ ูุธููุฉ ุงูุฅุบูุงู ุงูุฌุฒุฆู

ูููู ูููุณุชุฎุฏู ุฅุบูุงู ุงููุฑูุฒ ุฌุฒุฆูุงูุ ูุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ ุจูุฑููุฉ: โ๏ธ

### 7.1 ๐ ุฅุบูุงู ุฌุฒุฆู ููุฑูุฒ ุงูุดุฑุงุก

```mermaid
graph TB
    A[ูุญุชูุธ ุจู 1000 ุฑูุฒ<br/>ูุฑุถ 10 SOL] --> B[ุจูุน 400 ุฑูุฒ]
    B --> C[ุงูุญุตูู ุนูู 4.5 SOL]
    C --> D{ุชูุฒูุน ุงูุฃููุงู}
    D --> E[ุฎุตู ุงูุฑุณูู 0.02 SOL]
    D --> F[ุฅุนุงุฏุฉ ุงููุฑุถ 3.8 SOL]
    D --> G[ุณุญุจ ุงูุฑุจุญ 0.68 SOL<br/>ูููุณุชุฎุฏู]
    F --> H[ุชุญุฏูุซ ูุฌูุน ุงูุฅูุฑุงุถ<br/>borrow_sol_reserve +3.8]
    E --> I[ุงูุฏูุน ููุณุชูู ุงูุฑุณูู]
    G --> J[ุชุญููู ุฅูู ุญุณุงุจ ุงููุณุชุฎุฏู]

    H --> K[ุชุญุฏูุซ ุญุงูุฉ ุงูุฃูุฑ]
    I --> K
    J --> K

    K --> L[ุงููุฑูุฒ ุงููุชุจูู:<br/>600 ุฑูุฒ<br/>ูุฑุถ 6.2 SOL<br/>ุชุญุฏูุซ ุณุนุฑ ููู ุงูุฎุณุงุฑุฉ ุงูุฌุฏูุฏ]

    style A fill:#e1f5ff
    style L fill:#fff4e1
    style G fill:#d4edda
    style E fill:#f8d7da
```

**ุชูุงุตูู ุชุญุฏูุซ ุงูุฃูุฑ**:

| ุงูุญูู | ูุจู ุงูุฅุบูุงู | ุจุนุฏ ุงูุฅุบูุงู | ุงููุตู |
|-----|-------|-------|------|
| `position_asset_amount` | 1000 ุฑูุฒ | 600 ุฑูุฒ | ุงููุฑูุฒ ุงููุชุจูู |
| `borrow_amount` | 10 SOL | 6.2 SOL | ุงููุฑุถ ุงููุชุจูู |
| `lock_lp_start_price` | ุณุนุฑ ููู ุงูุฎุณุงุฑุฉ ุงูุฃุตูู | ุณุนุฑ ููู ุงูุฎุณุงุฑุฉ ุงูุฌุฏูุฏ | ููุนุงุฏ ุญุณุงุจู ุญุณุจ ุงููุฑูุฒ ุงูุฌุฏูุฏ |
| `realized_sol_amount` | 0 SOL | 0.68 SOL | ุชุฑุงูู ุงูุฃุฑุจุงุญ ุงููุญููุฉ |

### 7.2 ๐ ุฅุบูุงู ุฌุฒุฆู ููุฑูุฒ ุงูุจูุน

```mermaid
graph TB
    A[ุงูุชุฑุงุถ 1000 ุฑูุฒ<br/>ูุญุชูุธ ุจู 12 SOL] --> B[ุงุณุชุฎุฏุงู 4 SOL ูุฅุนุงุฏุฉ ุดุฑุงุก 350 ุฑูุฒ]
    B --> C{ุงุณุชุฎุฏุงู ุงูุฃููุงู}
    C --> D[ุชูููุฉ ุดุฑุงุก ุงูุฑููุฒ 3.98 SOL]
    C --> E[ุงูุฑุณูู 0.02 SOL]
    D --> F[ุฅุนุงุฏุฉ 350 ุฑูุฒ ููุฌูุน ุงูุฅูุฑุงุถ]
    F --> G[ุชุญุฏูุซ ูุฌูุน ุงูุฅูุฑุงุถ<br/>borrow_token_reserve +350]

    A --> H[ุงููุงูุด ุงูุฃุตูู 2 SOL<br/>ุนุงุฆุฏ ุจูุน ุงูุฑููุฒ 12 SOL]
    H --> I[ุจุนุฏ ุงูุฅุบูุงู ุงููุชุจูู<br/>12 - 4 = 8 SOL]
    I --> J{ุญุณุงุจ ุงูุฑุจุญ ูุงูุฎุณุงุฑุฉ}
    J --> K[ุณุญุจ ุงูุฑุจุญ 1.5 SOL<br/>ูููุณุชุฎุฏู]
    K --> L[ุชุญููู ุฅูู ุญุณุงุจ ุงููุณุชุฎุฏู]

    G --> M[ุชุญุฏูุซ ุญุงูุฉ ุงูุฃูุฑ]
    E --> N[ุงูุฏูุน ููุณุชูู ุงูุฑุณูู]
    L --> M
    N --> M

    M --> O[ุงููุฑูุฒ ุงููุชุจูู:<br/>ูุฑุถ 650 ุฑูุฒ<br/>ูุญุชูุธ ุจู 6.5 SOL<br/>ุชุญุฏูุซ ุณุนุฑ ุฌูู ุงูุฑุจุญ ุงูุฌุฏูุฏ]

    style A fill:#ffe1e1
    style O fill:#fff4e1
    style K fill:#d4edda
    style E fill:#f8d7da
```

**ุชูุงุตูู ุชุญุฏูุซ ุงูุฃูุฑ**:

| ุงูุญูู | ูุจู ุงูุฅุบูุงู | ุจุนุฏ ุงูุฅุบูุงู | ุงููุตู |
|-----|-------|-------|------|
| `borrow_amount` | 1000 ุฑูุฒ | 650 ุฑูุฒ | ุงููุฑุถ ุงููุชุจูู (ุฑููุฒ) |
| `position_asset_amount` | 12 SOL | 6.5 SOL | SOL ุงููุญุชูุธ ุจู ุงููุชุจูู |
| `lock_lp_start_price` | ุณุนุฑ ุฌูู ุงูุฑุจุญ ุงูุฃุตูู | ุณุนุฑ ุฌูู ุงูุฑุจุญ ุงูุฌุฏูุฏ | ููุนุงุฏ ุญุณุงุจู ุญุณุจ ุงููุฑูุฒ ุงูุฌุฏูุฏ |
| `realized_sol_amount` | 0 SOL | 1.5 SOL | ุชุฑุงูู ุงูุฃุฑุจุงุญ ุงููุญููุฉ |

### 7.3 โ๏ธ ุญุฏ ุฃุฏูู ูููุฑูุฒ
ุจุนุฏ ุงูุฅุบูุงู ุงูุฌุฒุฆูุ ูุฌุจ ุฃู ูููู ุงููุฑูุฒ ุงููุชุจูู โฅ `MIN_TRADE_TOKEN_AMOUNT * 2`ุ ูููุน ุฅูุดุงุก ูุฑุงูุฒ ุตุบูุฑุฉ ุฌุฏุงู ูุง ูููู ุชุตููุชูุง.

## ุซุงููุงูุ ๐ ุงูุนูุงูุฉ ุจูู ูุฌูุน ุงูุฅูุฑุงุถ ููุฌูุน ุงูุณูููุฉ

### 8.1 ๐ ุนุฒู ุงูุฃููุงู
- **ูุฌูุน ุงูุณูููุฉ ุงูููุฑู**: `lp_sol_reserve` + `lp_token_reserve`
- **ูุฌูุน ุงูุฅูุฑุงุถ ุงูุงูุชุฑุงุถู**: `borrow_sol_reserve` + `borrow_token_reserve`

ุนูู ุงูุฑุบู ูู ุฃู ุงูุฃููุงู ุงููุนููุฉ ุฌููุนูุง ูู ููุณ `pool_sol_account` ู `pool_token_account`ุ ูุชู ุชุญููู ุงูุนุฒู ุงูููุทูู ูู ุฎูุงู ุขููุฉ ููู ูุทุงู ุงูุณุนุฑ. ๐ก๏ธ

### 8.2 ๐ ูุฒุงููุฉ ุงูุณุนุฑ
- ุงูุชุฏุงูู ุงูููุฑู ูุงูุชุฏุงูู ุจุงูุฑุงูุนุฉ ุงููุงููุฉ ูุดุชุฑูุงู ูู ููุณ `price` (ุณุนุฑ ุงูุณูู ุงูุญุงูู) ๐น
- ุจุนุฏ ุชุญุฏูุซ ุงูุณุนุฑุ ูุนูุฏ ุงููุธุงู ุญุณุงุจ ุงุญุชูุงุทู ุงูุณูููุฉ: `price_to_reserves(price)` โ๏ธ

### 8.3 ๐ค ุชูุงูู ุงูุณูููุฉ
- ูุทุงู ุงูุณุนุฑ ุงููููู ููุชุฏุงูู ุจุงูุฑุงูุนุฉ ุงููุงููุฉ ูุง ูุดุงุฑู ูู ุงูุชุฏุงูู ุงูููุฑู ๐
- ุงูุชุฏุงูู ุงูููุฑู ูููู ุฃู ูุคุฏู ุฅูู ุชูุนูู ุงูุชุตููุฉ ุงููุณุฑูุฉ ูุฃูุงูุฑ ุงูุฑุงูุนุฉ ุงููุงููุฉุ ููุง ูุญุฑุฑ ุงูุณูููุฉ โก

## ุชุงุณุนุงูุ โจ ุงููุฒุงูุง ุงูุฑุฆูุณูุฉ

| ุงูููุฒุฉ | ุงููุตู | ุงููุงุฆุฏุฉ |
|-----|------|------|
| ุงุญุชูุงุทู ุงูุชุฑุงุถู | ูุฌูุน ุงูุฅูุฑุงุถ ูู ุณุฌู ูุญุงุณุจูุ ูููุณ ูุฌูุน ุฃููุงู ูุนูู | ููุงุกุฉ ุฑุฃุณ ุงููุงู ุนุงููุฉุ ูุง ุญุงุฌุฉ ูุชูููู ุฅุถุงูู |
| ููู ูุทุงู ุงูุณุนุฑ | ุณุนุฑ ุงูุฅุบูุงู ูููู ุงูุชูุจุค ุจู | ูููู ูู ูุฎุงุทุฑ ุงูุชุตููุฉุ ูุญูู ูุฌูุน ุงูุฅูุฑุงุถ |
| ุฅูุฑุงุถ ุซูุงุฆู ุงูุงุชุฌุงู | ูุฏุนู ุฅูุฑุงุถ SOL ูุงูุฑููุฒ ูู ููุง ุงูุงุชุฌุงููู | ูุธุงุฆู ุงูุดุฑุงุก ูุงูุจูุน ูุงููุฉ |
| ุฅุบูุงู ุฌุฒุฆู | ุชุนุฏูู ุงููุฑุงูุฒ ุจูุฑููุฉ | ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฌูุฏุฉุ ูุฎุงุทุฑ ูุงุจูุฉ ููุชุญูู |
| ุชุตููุฉ ุนูุฏ ุงูุงูุชูุงุก | ุญุฏ ุฒููู + ุญุงูุฒ ููุฃุทุฑุงู ุงูุซุงูุซุฉ | ูุถูู ุฅุนุงุฏุฉ ุงูุฃููุงู ูู ุงูููุช ุงูููุงุณุจ |


